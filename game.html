<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Text-Based RPG</title>
  <style>
    body {
      background-color: #121212;
      color: #eee;
      font-family: monospace;
      padding: 20px;
    }
    button {
      background-color: #333;
      color: #eee;
      border: none;
      padding: 10px;
      margin: 5px;
      cursor: pointer;
      border-radius: 5px;
    }
    button:hover {
      background-color: #555;
    }
    #game-output {
      margin-bottom: 10px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

  <h1>üó°Ô∏è Text RPG</h1>
  <div id="game-output"></div>
  <div id="game-choices"></div>

  <script>
    class Game {
      constructor() {
        this.player = {
          health: 100,
          maxHealth: 100,
          gold: 50,
          inventory: [],
          attack: 10,
        };

        this.monsters = {
          goblin: { name: "Goblin", health: 30, attack: 5 }
        };

        this.shopItems = [
          { name: "Health Potion", price: 10 },
          { name: "Sword", price: 25 }
        ];

        this.quests = {
          goblinHunt: {
            name: "Goblin Hunt",
            description: "Defeat 3 Goblins",
            progress: 0,
            target: 3,
            completed: false
          }
        };

        this.currentMonster = null;
        this.output = document.getElementById("game-output");
        this.choices = document.getElementById("game-choices");
      }

      start() {
        this.town();
      }

      showText(text) {
        this.output.innerHTML = text;
      }

      showChoices(options) {
        this.choices.innerHTML = "";
        options.forEach(opt => {
          const btn = document.createElement("button");
          btn.textContent = opt.text;
          btn.onclick = () => opt.action(opt.data);
          this.choices.appendChild(btn);
        });
      }

      town() {
        this.showText(`üè† You are in town.\nHP: ${this.player.health}/${this.player.maxHealth} | Gold: ${this.player.gold}`);
        this.showChoices([
          { text: "Go to Forest", action: () => this.forest() },
          { text: "View Quests", action: () => this.viewQuests() },
          { text: "Go to Shop", action: () => this.shop() }
        ]);
      }

      forest() {
        const goblin = { ...this.monsters.goblin }; // clone so we reset HP
        this.currentMonster = goblin;
        this.showText(`üå≤ A wild ${goblin.name} appears! HP: ${goblin.health}`);
        this.showChoices([
          { text: "Attack", action: () => this.fight() },
          { text: "Run", action: () => this.town() }
        ]);
      }

      fight() {
        const monster = this.currentMonster;
        monster.health -= this.player.attack;

        let log = `üó°Ô∏è You attack the ${monster.name}!\n`;

        if (monster.health <= 0) {
          log += `üíÄ You defeated the ${monster.name}!\n`;

          // Quest progress
          const quest = this.quests.goblinHunt;
          if (!quest.completed) {
            quest.progress++;
            if (quest.progress >= quest.target) {
              quest.completed = true;
              log += `‚úÖ Quest completed: ${quest.name}!\n`;
            }
          }

          this.showText(log);
          this.showChoices([{ text: "Back to Town", action: () => this.town() }]);
        } else {
          // Monster attacks back
          this.player.health -= monster.attack;
          log += `The ${monster.name} strikes back! You lose ${monster.attack} HP.\nYour HP: ${this.player.health}`;

          if (this.player.health <= 0) {
            this.showText("‚ò†Ô∏è You have been defeated! Game Over.");
            this.showChoices([]);
          } else {
            this.showText(log + `\n${monster.name}'s HP: ${monster.health}`);
            this.showChoices([
              { text: "Attack Again", action: () => this.fight() },
              { text: "Run", action: () => this.town() }
            ]);
          }
        }
      }

      viewQuests() {
        const q = this.quests.goblinHunt;
        const text = `üìú ${q.name}: ${q.description}\nProgress: ${q.progress}/${q.target}\nStatus: ${q.completed ? "‚úÖ Completed" : "In Progress"}`;
        this.showText(text);
        this.showChoices([{ text: "Back to Town", action: () => this.town() }]);
      }

      shop() {
        let text = "üõí Welcome to the shop:\n";
        this.shopItems.forEach((item, i) => {
          text += `${i + 1}. ${item.name} - ${item.price} gold\n`;
        });
        this.showText(text);

        const buttons = this.shopItems.map((item, i) => ({
          text: `Buy ${item.name}`,
          action: () => this.buy(item)
        }));
        buttons.push({ text: "Back to Town", action: () => this.town() });
        this.showChoices(buttons);
      }

      buy(item) {
        if (this.player.gold >= item.price) {
          this.player.gold -= item.price;
          this.player.inventory.push(item.name);
          if (item.name === "Health Potion") {
            this.player.health = Math.min(this.player.maxHealth, this.player.health + 30);
          }
          if (item.name === "Sword") {
            this.player.attack += 5;
          }
          this.showText(`You bought a ${item.name}.\nHP: ${this.player.health} | Gold: ${this.player.gold}`);
        } else {
          this.showText("Not enough gold!");
        }
        this.showChoices([{ text: "Back to Shop", action: () => this.shop() }]);
      }
    }

    const game = new Game();
    game.start();
  </script>
</body>
</html>
